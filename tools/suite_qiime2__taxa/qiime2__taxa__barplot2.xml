<?xml version='1.0' encoding='utf-8'?>
<!--
Copyright (c) 2025, QIIME 2 development team.

Distributed under the terms of the Modified BSD License. (SPDX: BSD-3-Clause)
-->
<!--
This tool was automatically generated by:
    q2galaxy (version: 2025.10.0)
for:
    qiime2 (version: 2025.10.0)
-->
<tool name="qiime2 taxa barplot2" id="qiime2__taxa__barplot2" version="2025.10.0+q2galaxy.2025.10.0" profile="22.05" license="BSD-3-Clause">
    <description>Experimental interactive stacked bar plot of per-sample taxa.</description>
    <xrefs>
        <xref type="bio.tools">qiime2</xref>
    </xrefs>
    <requirements>
        <container type="docker">quay.io/qiime2/amplicon:2025.10</container>
    </requirements>
    <version_command>q2galaxy version taxa</version_command>
    <command detect_errors="exit_code">q2galaxy run taxa barplot2 '$inputs'</command>
    <configfiles>
        <inputs name="inputs" data_style="staging_path_and_source_path"/>
    </configfiles>
    <inputs>
        <param name="table" type="data" format="qza" label="table: FeatureTable[Frequency | PresenceAbsence | RelativeFrequency]" help="[required]  Feature table to visualize at various taxonomic levels.">
            <options options_filter_attribute="metadata.semantic_type">
                <filter type="add_value" value="FeatureTable[PresenceAbsence]"/>
                <filter type="add_value" value="FeatureTable[Frequency]"/>
                <filter type="add_value" value="FeatureTable[RelativeFrequency]"/>
            </options>
            <validator type="expression" message="Incompatible type">hasattr(value.metadata, "semantic_type") and value.metadata.semantic_type in ['FeatureTable[Frequency]', 'FeatureTable[PresenceAbsence]', 'FeatureTable[RelativeFrequency]']</validator>
        </param>
        <section name="__q2galaxy__GUI__section__extra_opts__" title="Click here for additional options">
            <param name="taxonomy" type="data" format="qza" optional="true" label="taxonomy: FeatureData[Taxonomy]" help="[optional]  Taxonomic annotations for features in the provided feature table. All features in the feature table must have a corresponding taxonomic annotation. Taxonomic annotations that are not present in the feature table will be ignored. If no taxonomy is provided, the feature IDs will be used as labels.">
                <options options_filter_attribute="metadata.semantic_type">
                    <filter type="add_value" value="FeatureData[Taxonomy]"/>
                </options>
                <validator type="expression" message="Incompatible type">hasattr(value.metadata, "semantic_type") and value.metadata.semantic_type in ['FeatureData[Taxonomy]']</validator>
            </param>
            <repeat name="metadata" help="[optional]  The sample metadata." title="metadata: Metadata">
                <conditional name="__q2galaxy__GUI__conditional__metadata__">
                    <param name="type" type="select" label="metadata: Metadata">
                        <option value="tsv" selected="true">Metadata from TSV</option>
                        <option value="qza">Metadata from Artifact</option>
                    </param>
                    <when value="tsv">
                        <param name="source" type="data" format="tabular,qiime2.tabular" label="Metadata Source"/>
                    </when>
                    <when value="qza">
                        <param name="source" type="data" format="qza" label="Metadata Source"/>
                    </when>
                </conditional>
            </repeat>
            <conditional name="__q2galaxy__GUI__conditional__level_delimiter__" label="level_delimiter: Str">
                <param name="__q2galaxy__GUI__select__" type="select" label="level_delimiter: Str" help="[optional]  Attempt to parse hierarchical taxonomic information from feature IDs by separating levels with this character. This parameter is ignored if a taxonomy is provided as input.">
                    <option value="__q2galaxy__::control::default" selected="true">None (Use default behavior)</option>
                    <option value="__q2galaxy__::control::provide">Provide a value</option>
                </param>
                <when value="__q2galaxy__::control::default">
                    <param name="level_delimiter" type="hidden" value="__q2galaxy__::literal::None"/>
                </when>
                <when value="__q2galaxy__::control::provide">
                    <param name="level_delimiter" type="text">
                        <sanitizer>
                            <valid initial="string.printable"/>
                        </sanitizer>
                    </param>
                </when>
            </conditional>
        </section>
    </inputs>
    <outputs>
        <data name="visualization" format="qzv" label="${tool.name} on ${on_string}: visualization.qzv" from_work_dir="visualization.qzv"/>
    </outputs>
    <tests>
        <test>
            <param name="table" value="barplot2.test0.table.qza" ftype="qza"/>
            <param name="taxonomy" value="barplot2.test0.taxonomy.qza" ftype="qza"/>
            <repeat name="metadata">
                <conditional name="__q2galaxy__GUI__conditional__metadata__">
                    <param name="type" value="tsv"/>
                    <param name="source" value="barplot2.test0.sample-metadata.tsv" ftype="qiime2.tabular"/>
                </conditional>
            </repeat>
            <output name="visualization" ftype="qzv">
                <assert_contents>
                    <has_archive_member path="[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}\/metadata.yaml">
                        <has_line_matching expression="type: Visualization"/>
                    </has_archive_member>
                </assert_contents>
            </output>
        </test>
    </tests>
    <help>
QIIME 2: taxa barplot2
======================
Experimental interactive stacked bar plot of per-sample taxa.


Outputs:
--------
:visualization.qzv: &lt;no description&gt;

|  

Description:
------------
This is an early release of a replacement for the `barplot` visualizer in this plugin. As of 2025.10, this should be considered experimental, and we are very interested in community feedback on this new visualizer. This command will eventually be removed when this visualizer replaces the `barplot` visualizer.

Examples:
---------

barplot
*******
Using the ``qiime2 taxa barplot2`` tool:
 #. Set *"table"* to ``#: table.qza``
 #. Expand the ``additional options`` section

    #. Set *"taxonomy"* to ``#: taxonomy.qza``
    #. For *"metadata"*:

       - Press the ``+ Insert metadata`` button to set up the next steps.

         #. Leave as ``Metadata from TSV``
         #. Set *"Metadata Source"* to ``sample-metadata.tsv``



 #. Press the ``Execute`` button.

Once completed, for the new entry in your history, use the ``Edit`` button to set the name as follows:
 (Renaming is optional, but it will make any subsequent steps easier to complete.)

 .. list-table::
    :align: left
    :header-rows: 1

    * - History Name
      - *"Name"* to set (be sure to press ``Save``)
    * - ``#: qiime2 taxa barplot2 [...] : visualization.qzv``
      - ``taxa-bar-plots.qzv``


|  

</help>
    <citations>
        <citation type="doi">10.1038/s41587-019-0209-9</citation>
    </citations>
</tool>
