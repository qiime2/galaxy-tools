<?xml version='1.0' encoding='utf-8'?>
<!--
Copyright (c) 2022, QIIME 2 development team.

Distributed under the terms of the Modified BSD License. (SPDX: BSD-3-Clause)
-->
<!--
This tool was automatically generated by:
    q2galaxy (version: 2022.2.0)
for:
    qiime2 (version: 2022.2.1)
-->
<tool name="qiime2 diversity-lib unweighted-unifrac" id="qiime2_diversity-lib_unweighted-unifrac" version="2022.2.1+q2galaxy.2022.2.0" profile="20.09" license="BSD-3-Clause">
    <description>Unweighted Unifrac</description>
    <requirements>
        <container type="docker">quay.io/qiime2/core:2022.2</container>
    </requirements>
    <version_command>q2galaxy version diversity_lib</version_command>
    <command detect_errors="aggressive">q2galaxy run diversity_lib unweighted_unifrac '$inputs'</command>
    <configfiles>
        <inputs name="inputs" data_style="paths"/>
    </configfiles>
    <inputs>
        <param name="table" type="data" format="qza" label="table: FeatureTable[Frequency | RelativeFrequency | PresenceAbsence]" help="[required]  The feature table containing the samples for which Unweighted Unifrac should be computed.">
            <options options_filter_attribute="metadata.semantic_type">
                <filter type="add_value" value="FeatureTable[RelativeFrequency]"/>
                <filter type="add_value" value="FeatureTable[Frequency]"/>
                <filter type="add_value" value="FeatureTable[PresenceAbsence]"/>
            </options>
            <validator type="expression" message="Incompatible type">hasattr(value.metadata, "semantic_type") and value.metadata.semantic_type in {'FeatureTable[Frequency]', 'FeatureTable[RelativeFrequency]', 'FeatureTable[PresenceAbsence]'}</validator>
        </param>
        <param name="phylogeny" type="data" format="qza" label="phylogeny: Phylogeny[Rooted]" help="[required]  Phylogenetic tree containing tip identifiers that correspond to the feature identifiers in the table. This tree can contain tip ids that are not present in the table, but all feature ids in the table must be present in this tree.">
            <options options_filter_attribute="metadata.semantic_type">
                <filter type="add_value" value="Phylogeny[Rooted]"/>
            </options>
            <validator type="expression" message="Incompatible type">hasattr(value.metadata, "semantic_type") and value.metadata.semantic_type in {'Phylogeny[Rooted]'}</validator>
        </param>
        <section name="__q2galaxy__GUI__section__extra_opts__" title="Click here for additional options">
            <conditional name="__q2galaxy__GUI__conditional__threads__">
                <param name="__q2galaxy__GUI__select__" type="select" label="threads: Int % Range(1, None) | Str % Choices('auto')" help="[default: 1]  The number of CPU threads to use in performing this calculation. May not exceed the number of available physical cores. If threads = 'auto', one thread will be created for each identified CPU core on the host.">
                    <option value="auto">auto (Str)</option>
                    <option value="__q2galaxy__::control::Int X Range(1__comma__ None)" selected="true">Provide a value (Int % Range(1, None))</option>
                </param>
                <when value="auto">
                    <param name="threads" type="hidden" value="auto"/>
                </when>
                <when value="__q2galaxy__::control::Int X Range(1__comma__ None)">
                    <param name="threads" type="integer" min="1" value="1" label="threads: Int % Range(1, None)" help="[default: 1]  The number of CPU threads to use in performing this calculation. May not exceed the number of available physical cores. If threads = 'auto', one thread will be created for each identified CPU core on the host."/>
                </when>
            </conditional>
            <param name="bypass_tips" type="boolean" truevalue="__q2galaxy__::literal::True" falsevalue="__q2galaxy__::literal::False" label="bypass_tips: Bool" help="[default: No]  In a bifurcating tree, the tips make up about 50% of the nodes in a tree. By ignoring them, specificity can be traded for reduced compute time. This has the effect of collapsing the phylogeny, and is analogous (in concept) to moving from 99% to 97% OTUs"/>
        </section>
    </inputs>
    <outputs>
        <data name="distance_matrix" format="qza" label="${tool.id} on ${on_string}: distance_matrix.qza" from_work_dir="distance_matrix.qza"/>
    </outputs>
    <tests/>
    <help>
QIIME 2: diversity-lib unweighted-unifrac
=========================================
Unweighted Unifrac


Outputs:
--------
:distance_matrix.qza: Distance matrix for Unweighted Unifrac.

|  

Description:
------------
Compute Unweighted Unifrac for each sample in a feature table


|  

</help>
    <citations>
        <citation type="bibtex">@article{cite1,
 abstract = {We introduce here a new method for computing differences between microbial communities based on phylogenetic information. This method, UniFrac, measures the phylogenetic distance between sets of taxa in a phylogenetic tree as the fraction of the branch length of the tree that leads to descendants from either one environment or the other, but not both. UniFrac can be used to determine whether communities are significantly different, to compare many communities simultaneously using clustering and ordination techniques, and to measure the relative contributions of different factors, such as chemistry and geography, to similarities between samples. We demonstrate the utility of UniFrac by applying it to published 16S rRNA gene libraries from cultured isolates and environmental clones of bacteria in marine sediment, water, and ice. Our results reveal that (i) cultured isolates from ice, water, and sediment resemble each other and environmental clone sequences from sea ice, but not environmental clone sequences from sediment and water; (ii) the geographical location does not correlate strongly with bacterial community differences in ice and sediment from the Arctic and Antarctic; and (iii) bacterial communities differ between terrestrially impacted seawater (whether polar or temperate) and warm oligotrophic seawater, whereas those in individual seawater samples are not more similar to each other than to those in sediment or ice samples. These results illustrate that UniFrac provides a new way of characterizing microbial communities, using the wealth of environmental rRNA sequences, and allows quantitative insight into the factors that underlie the distribution of lineages among environments.},
 author = {Lozupone, Catherine and Knight, Rob},
 doi = {10.1128/AEM.71.12.8228-8235.2005},
 eprint = {https://aem.asm.org/content/71/12/8228.full.pdf},
 issn = {0099-2240},
 journal = {Applied and Environmental Microbiology},
 number = {12},
 pages = {8228--8235},
 publisher = {American Society for Microbiology Journals},
 title = {UniFrac: a New Phylogenetic Method for Comparing Microbial Communities},
 url = {https://aem.asm.org/content/71/12/8228},
 volume = {71},
 year = {2005}
}

</citation>
        <citation type="bibtex">@article{cite2,
 abstract = {The assessment of microbial diversity and distribution is a major concern in environmental microbiology. There are two general approaches for measuring community diversity: quantitative measures, which use the abundance of each taxon, and qualitative measures, which use only the presence/absence of data. Quantitative measures are ideally suited to revealing community differences that are due to changes in relative taxon abundance (e.g., when a particular set of taxa flourish because a limiting nutrient source becomes abundant). Qualitative measures are most informative when communities differ primarily by what can live in them (e.g., at high temperatures), in part because abundance information can obscure significant patterns of variation in which taxa are present. We illustrate these principles using two 16S rRNA-based surveys of microbial populations and two phylogenetic measures of community β diversity: unweighted UniFrac, a qualitative measure, and weighted UniFrac, a new quantitative measure, which we have added to the UniFrac website (http://bmf.colorado.edu/unifrac). These studies considered the relative influences of mineral chemistry, temperature, and geography on microbial community composition in acidic thermal springs in Yellowstone National Park and the influences of obesity and kinship on microbial community composition in the mouse gut. We show that applying qualitative and quantitative measures to the same data set can lead to dramatically different conclusions about the main factors that structure microbial diversity and can provide insight into the nature of community differences. We also demonstrate that both weighted and unweighted UniFrac measurements are robust to the methods used to build the underlying phylogeny.},
 author = {Lozupone, Catherine A. and Hamady, Micah and Kelley, Scott T. and Knight, Rob},
 doi = {10.1128/AEM.01996-06},
 eprint = {https://aem.asm.org/content/73/5/1576.full.pdf},
 issn = {0099-2240},
 journal = {Applied and Environmental Microbiology},
 number = {5},
 pages = {1576--1585},
 publisher = {American Society for Microbiology Journals},
 title = {Quantitative and Qualitative β Diversity Measures Lead to Different Insights into Factors That Structure Microbial Communities},
 url = {https://aem.asm.org/content/73/5/1576},
 volume = {73},
 year = {2007}
}

</citation>
        <citation type="bibtex">@article{cite3,
 abstract = {Next-generation sequencing techniques, and PhyloChip, have made simultaneous phylogenetic analyses of hundreds of microbial communities possible. Insight into community structure has been limited by the inability to integrate and visualize such vast datasets. Fast UniFrac overcomes these issues, allowing integration of larger numbers of sequences and samples into a single analysis. Its new array-based implementation offers orders of magnitude improvements over the original version. New 3D visualization of principal coordinates analysis results, with the option to view multiple coordinate axes simultaneously, provides a powerful way to quickly identify patterns that relate vast numbers of microbial communities. We show the potential of Fast UniFrac using examples from three data types: Sanger-sequencing studies of diverse free-living and animal-associated bacterial assemblages and from the gut of obese humans as they diet, pyrosequencing data integrated from studies of the human hand and gut, and PhyloChip data from a study of citrus pathogens. We show that a Fast UniFrac analysis using a reference tree recaptures patterns that could not be detected without considering phylogenetic relationships and that Fast UniFrac, coupled with BLAST-based sequence assignment, can be used to quickly analyze pyrosequencing runs containing hundreds of thousands of sequences, showing patterns relating human and gut samples. Finally, we show that the application of Fast UniFrac to PhyloChip data could identify well-defined subcategories associated with infection. Together, these case studies point the way toward a broad range of applications and show some of the new features of Fast UniFrac.},
 author = {Hamady, Micah and Lozupone, Catherine and Knight, Rob},
 doi = {10.1038/ismej.2009.97},
 issn = {1751-7370},
 issue = {1},
 journal = {The ISME Journal},
 pages = {17--27},
 title = {Fast UniFrac: facilitating high-throughput phylogenetic analyses of microbial communities including analysis of pyrosequencing and PhyloChip data},
 volume = {4},
 year = {2010}
}

</citation>
        <citation type="bibtex">@article{cite4,
 author = {Lozupone, Catherine and Lladser, Manuel E and Knights, Dan and Stombaugh, Jesse and Knight, Rob},
 doi = {10.1038/ismej.2010.133},
 issn = {1751-7370},
 issue = {2},
 journal = {The ISME Journal},
 pages = {169--172},
 title = {UniFrac: an effective distance metric for microbial community comparison},
 volume = {5},
 year = {2011}
}

</citation>
        <citation type="bibtex">@article{cite5,
 author = {McDonald, Daniel and Vázquez-Baeza, Yoshiki and Koslicki, David and McClelland, Jason and Reeve, Nicolai and Xu, Zhenjiang and Gonzalez, Antonio and Knight, Rob},
 doi = {10.1038/s41592-018-0187-8},
 issn = {1548-7105},
 issue = {11},
 journal = {Nature Methods},
 pages = {847--848},
 title = {Striped UniFrac: enabling microbiome analysis at unprecedented scale},
 volume = {15},
 year = {2018}
}

</citation>
        <citation type="bibtex">@article{cite6,
 author = {Bolyen, Evan and Rideout, Jai Ram and Dillon, Matthew R. and Bokulich, Nicholas A. and Abnet, Christian C. and Al-Ghalith, Gabriel A. and Alexander, Harriet and Alm, Eric J. and Arumugam, Manimozhiyan and Asnicar, Francesco and Bai, Yang and Bisanz, Jordan E. and Bittinger, Kyle and Brejnrod, Asker and Brislawn, Colin J. and Brown, C. Titus and Callahan, Benjamin J. and Caraballo-Rodríguez, Andrés Mauricio and Chase, John and Cope, Emily K. and Da Silva, Ricardo and Diener, Christian and Dorrestein, Pieter C. and Douglas, Gavin M. and Durall, Daniel M. and Duvallet, Claire and Edwardson, Christian F. and Ernst, Madeleine and Estaki, Mehrbod and Fouquier, Jennifer and Gauglitz, Julia M. and Gibbons, Sean M. and Gibson, Deanna L. and Gonzalez, Antonio and Gorlick, Kestrel and Guo, Jiarong and Hillmann, Benjamin and Holmes, Susan and Holste, Hannes and Huttenhower, Curtis and Huttley, Gavin A. and Janssen, Stefan and Jarmusch, Alan K. and Jiang, Lingjing and Kaehler, Benjamin D. and Kang, Kyo Bin and Keefe, Christopher R. and Keim, Paul and Kelley, Scott T. and Knights, Dan and Koester, Irina and Kosciolek, Tomasz and Kreps, Jorden and Langille, Morgan G. I. and Lee, Joslynn and Ley, Ruth and Liu, Yong-Xin and Loftfield, Erikka and Lozupone, Catherine and Maher, Massoud and Marotz, Clarisse and Martin, Bryan D. and McDonald, Daniel and McIver, Lauren J. and Melnik, Alexey V. and Metcalf, Jessica L. and Morgan, Sydney C. and Morton, Jamie T. and Naimey, Ahmad Turan and Navas-Molina, Jose A. and Nothias, Louis Felix and Orchanian, Stephanie B. and Pearson, Talima and Peoples, Samuel L. and Petras, Daniel and Preuss, Mary Lai and Pruesse, Elmar and Rasmussen, Lasse Buur and Rivers, Adam and Robeson, Michael S. and Rosenthal, Patrick and Segata, Nicola and Shaffer, Michael and Shiffer, Arron and Sinha, Rashmi and Song, Se Jin and Spear, John R. and Swafford, Austin D. and Thompson, Luke R. and Torres, Pedro J. and Trinh, Pauline and Tripathi, Anupriya and Turnbaugh, Peter J. and Ul-Hasan, Sabah and van der Hooft, Justin J. J. and Vargas, Fernando and Vázquez-Baeza, Yoshiki and Vogtmann, Emily and von Hippel, Max and Walters, William and Wan, Yunhu and Wang, Mingxun and Warren, Jonathan and Weber, Kyle C. and Williamson, Charles H. D. and Willis, Amy D. and Xu, Zhenjiang Zech and Zaneveld, Jesse R. and Zhang, Yilong and Zhu, Qiyun and Knight, Rob and Caporaso, J. Gregory},
 doi = {10.1038/s41587-019-0209-9},
 issn = {1546-1696},
 journal = {Nature Biotechnology},
 number = {8},
 pages = {852-857},
 title = {Reproducible, interactive, scalable and extensible microbiome data science using QIIME 2},
 url = {https://doi.org/10.1038/s41587-019-0209-9},
 volume = {37},
 year = {2019}
}

</citation>
    </citations>
</tool>
