<?xml version='1.0' encoding='utf-8'?>
<!--
Copyright (c) 2022, QIIME 2 development team.

Distributed under the terms of the Modified BSD License. (SPDX: BSD-3-Clause)
-->
<!--
This tool was automatically generated by:
    q2galaxy (version: 2022.8.1)
for:
    qiime2 (version: 2022.8.3)
-->
<tool name="qiime2 phylogeny align-to-tree-mafft-raxml" id="qiime2__phylogeny__align_to_tree_mafft_raxml" version="2022.8.0+q2galaxy.2022.8.1.2" profile="22.05" license="BSD-3-Clause">
    <description>Build a phylogenetic tree using raxml and mafft alignment.</description>
    <requirements>
        <container type="docker">quay.io/qiime2/core:2022.8</container>
    </requirements>
    <version_command>q2galaxy version phylogeny</version_command>
    <command detect_errors="aggressive">q2galaxy run phylogeny align_to_tree_mafft_raxml '$inputs'</command>
    <configfiles>
        <inputs name="inputs" data_style="paths"/>
    </configfiles>
    <inputs>
        <param name="sequences" type="data" format="qza" label="sequences: FeatureData[Sequence]" help="[required]  The sequences to be used for creating a iqtree based rooted phylogenetic tree.">
            <options options_filter_attribute="metadata.semantic_type">
                <filter type="add_value" value="FeatureData[Sequence]"/>
            </options>
            <validator type="expression" message="Incompatible type">hasattr(value.metadata, "semantic_type") and value.metadata.semantic_type in ['FeatureData[Sequence]']</validator>
        </param>
        <section name="__q2galaxy__GUI__section__extra_opts__" title="Click here for additional options">
            <conditional name="__q2galaxy__GUI__conditional__n_threads__">
                <param name="__q2galaxy__GUI__select__" type="select" label="n_threads: Int % Range(1, None) | Str % Choices('auto')" help="[default: 1]  The number of threads. (Use `all` to automatically use all available cores. This value is used when aligning the sequences and creating the tree with iqtree.">
                    <option value="auto">auto (Str)</option>
                    <option value="__q2galaxy__::control::Int X Range(1__comma__ None)" selected="true">Provide a value (Int % Range(1, None))</option>
                </param>
                <when value="auto">
                    <param name="n_threads" type="hidden" value="auto"/>
                </when>
                <when value="__q2galaxy__::control::Int X Range(1__comma__ None)">
                    <param name="n_threads" type="integer" min="1" value="1" label="n_threads: Int % Range(1, None)" help="[default: 1]  The number of threads. (Use `all` to automatically use all available cores. This value is used when aligning the sequences and creating the tree with iqtree."/>
                </when>
            </conditional>
            <param name="mask_max_gap_frequency" type="float" min="0" max="1" value="1.0" label="mask_max_gap_frequency: Float % Range(0, 1, inclusive_end=True)" help="[default: 1.0]  The maximum relative frequency of gap characters in a column for the column to be retained. This relative frequency must be a number between 0.0 and 1.0 (inclusive), where 0.0 retains only those columns without gap characters, and 1.0 retains all columns  regardless of gap character frequency. This value is used when masking the aligned sequences."/>
            <param name="mask_min_conservation" type="float" min="0" max="1" value="0.4" label="mask_min_conservation: Float % Range(0, 1, inclusive_end=True)" help="[default: 0.4]  The minimum relative frequency of at least one non-gap character in a column for that column to be retained. This relative frequency must be a number between 0.0 and 1.0 (inclusive). For example, if a value of  0.4 is provided, a column will only be retained  if it contains at least one character that is present in at least 40% of the sequences. This value is used when masking the aligned sequences."/>
            <param name="parttree" type="boolean" truevalue="__q2galaxy__::literal::True" falsevalue="__q2galaxy__::literal::False" label="parttree: Bool" help="[default: No]  This flag is required if the number of sequences being aligned are larger than 1000000. Disabled by default. NOTE: if using this option, it is recomended that only the CAT-based substitution models of RAxML be considered for this pipeline."/>
            <param name="substitution_model" type="select" label="substitution_model: Str % Choices('GTRGAMMA', 'GTRGAMMAI', 'GTRCAT', 'GTRCATI')" display="radio">
                <option value="GTRGAMMA" selected="true">GTRGAMMA</option>
                <option value="GTRGAMMAI">GTRGAMMAI</option>
                <option value="GTRCAT">GTRCAT</option>
                <option value="GTRCATI">GTRCATI</option>
            </param>
            <param name="seed" type="integer" optional="true" label="seed: Int" help="[optional]  Random number seed for the parsimony starting tree. This allows you to reproduce tree results. If not supplied then one will be randomly chosen."/>
            <param name="raxml_version" type="select" label="raxml_version: Str % Choices('Standard', 'SSE3', 'AVX2')" display="radio">
                <option value="Standard" selected="true">Standard</option>
                <option value="SSE3">SSE3</option>
                <option value="AVX2">AVX2</option>
            </param>
        </section>
    </inputs>
    <outputs>
        <data name="alignment" format="qza" label="${tool.name} on ${on_string}: alignment.qza" from_work_dir="alignment.qza"/>
        <data name="masked_alignment" format="qza" label="${tool.name} on ${on_string}: masked_alignment.qza" from_work_dir="masked_alignment.qza"/>
        <data name="tree" format="qza" label="${tool.name} on ${on_string}: tree.qza" from_work_dir="tree.qza"/>
        <data name="rooted_tree" format="qza" label="${tool.name} on ${on_string}: rooted_tree.qza" from_work_dir="rooted_tree.qza"/>
    </outputs>
    <tests/>
    <help>
QIIME 2: phylogeny align-to-tree-mafft-raxml
============================================
Build a phylogenetic tree using raxml and mafft alignment.


Outputs:
--------
:alignment.qza: The aligned sequences.
:masked_alignment.qza: The masked alignment.
:tree.qza: The unrooted phylogenetic tree.
:rooted_tree.qza: The rooted phylogenetic tree.

|  

Description:
------------
This pipeline will start by creating a sequence alignment using MAFFT, after which any alignment columns that are phylogenetically uninformative or ambiguously aligned will be removed (masked). The resulting masked alignment will be used to infer a phylogenetic tree using RAxML, under the specified substitution model, and then subsequently rooted at its midpoint. Output files from each step of the pipeline will be saved. This includes both the unmasked and masked MAFFT alignment from q2-alignment methods, and both the rooted and unrooted phylogenies from q2-phylogeny methods.


|  

</help>
    <citations>
        <citation type="doi">10.1038/s41587-019-0209-9</citation>
    </citations>
</tool>
